# -*- coding: utf-8 -*-
"""Analise - PERSE

Automatically generated by Colab.

import pandas as pd

"""IMPORT CSV TO PANDAS"""

df = pd.read_csv("/content/renuncia-por-regime.csv", sep=';')
df.head(5)

"""1° Removendo o . e substituindo , por . para ficar no formato ideal de numero > Transformando de Object para Float

2° FILTRANDO PARA OBTER SOMENTE AS COLUNAS DESEJADAS
"""

# Limpar e converter a coluna 'valor R$' para float
df['valor_consolidado_global'] = df['valor_consolidado_global'].str.replace('.', '', regex=False)  # Remove o separador de milhar
df['valor_consolidado_global'] = df['valor_consolidado_global'].str.replace(',', '.', regex=False)  # Substitui a vírgula pelo ponto
df['valor_consolidado_global'] = df['valor_consolidado_global'].astype(float)  # Converte para float

df.rename(columns={'periodo_apuracao': 'data', 'valor_consolidado_global': 'valor R$'}, inplace=True)
colunas_desejadas = ['data', 'valor R$', 'nome', 'uf']
df_novo = df[colunas_desejadas]

# Exibir as primeiras linhas do DataFrame após a conversão
print(df_novo.head())

"""Tranformando DATAFRAME em Csv"""

df_novo.to_csv('arquivo_parse_tratado.csv', index=False, sep=',')
